!function(){window.rocket=window.rocket||{}}(Zepto),!function(t){rocket.baseview=Backbone.View.extend({events:{},init:function(){},initialize:function(t,e){var n=this;n.options=t||{__empty:!0},n.parent=e||null,n.children={},n.length=0,n.ec=n.getRoot(),n.subec=n.getSubEC(),n.featureString=n.getFeatureString(),n.$globalLoading=rocket.$globalLoading,n.$pageLoading=rocket.$pageLoading,n.pageOrientation=n.pageOrientationToBe=window.orientation,n.init(n.options),n._registerEvents(),n.registerEvents()},getRoot:function(){var t,e,n=this;for(t=e=n;t;)e=t,t=t.parent;return e},getSubEC:function(){var t,e,n=this;for(t=e=n;t;){if(t instanceof rocket.subpageview)return t;e=t,t=t.parent}return e},getFeatureString:function(e){var n=this,i=e||n.options,r="";return r=t.param(i,!0),e||(n.featureString=r),r},showLoading:function(e){var n=this;e&&t(e).append(n.$pageLoading),n.$pageLoading.show(),n.$globalLoading.hide()},hideLoading:function(t){var e=this;return 0>t?(e.$globalLoading.hide(),e.$pageLoading.remove(),void 0):(setTimeout(function(){e.$pageLoading.remove()},void 0===t?300:t),void 0)},append:function(t){this._addSubview(t)},appendTo:function(t,e){this._addSubview(t,"APPENDTO",e)},prepend:function(t){this._addSubview(t,"PREPEND")},setup:function(t){this._addSubview(t,"SETUP")},_addSubview:function(e,n,i){var r=this;if(!(e instanceof rocket.baseview))throw new Error("rocket.view.append arguments must be an instance of rocket.view");switch(r.children[e.cid]=e,r.length++,e.parent=r,n){case"SETUP":break;case"PREPEND":r.$el.prepend(e.$el);break;case"APPENDTO":t(i).append(e.$el);break;default:r.$el.append(e.$el)}e.$el.hide()},remove:function(t){var e=this;t instanceof rocket.baseview?(delete e.children[t.cid],e.length--,t.parent=null,t.$el.remove()):e.parent&&e.parent.remove(e)},firstChild:function(){var t=this;for(var e in t.children)return t.children[e];return null},nextSibling:function(){var t=this,e=t.parent,n=null,i=null;if(!e)return null;for(var r in e.children)if(n=i,i=e.children[r],n==t)return i;return null},prevSibling:function(){var t=this,e=t.parent,n=null,i=null;if(!e)return null;for(var r in e.children)if(n=i,i=e.children[r],i==t)return n;return null},destroy:function(){var t=this;for(var e in t.children)t.children[e].destroy();t._unregisterEvents(),t.unregisterEvents(),t.undelegateEvents(),this.$el.remove(),t.el=t.$el=null,t.parent&&delete t.parent.children[t.cid]},registerEvents:function(){},unregisterEvents:function(){},onorientationchange:function(){},_registerEvents:function(){var e=this,n=e.ec;e._onorientationchange=function(){e.pageOrientationToBe=window.orientation,n.isActivePage()&&e.pageOrientation!=e.pageOrientationToBe&&(e.onorientationchange(e.pageOrientation,e.pageOrientationToBe),e.pageOrientation=e.pageOrientationToBe)},t(window).on("orientationchange",e._onorientationchange),n.on("pagebeforechange",e._onpagebeforechange,e),n.on("pageafterchange",e._onpageafterchange,e)},_unregisterEvents:function(){var e=this,n=e.ec;t(window).off("orientationchange",e._onorientationchange),e.onorientationchange=e.onsubpagebeforechange=e.onsubpageafterchange=function(){},n.off("pagebeforechange",e._onpagebeforechange,e),n.off("pageafterchange",e._onpageafterchange,e)},_onpagebeforechange:function(t){var e=this,n=t.from,i=t.to,r=t.params,o=e.getFeatureString(r),a=e.subpageManager;e.pageOrientation!=e.pageOrientationToBe&&(e.onorientationchange(e.pageOrientation,e.pageOrientationToBe),e.pageOrientation=e.pageOrientationToBe),a&&a._subpages.length&&i==e.ec&&n!=i&&a._currentSubpage&&a._currentSubpage.featureString!=o&&a._currentSubpage.$el.hide()},_onpageafterchange:function(e){var n,i,r=this,o=e.from,a=e.to,s=e.params,u=r.getFeatureString(s),c=r.subpageManager;if(a==r.ec&&c&&c._subpages.length){if(!c.getSubpage(u)){var l=new c._subpageClass(t.extend({},s),r);r.append(l),c.registerSubpage(u,l)}c.setCurrentSubpage(c.getSubpage(u)),n=c._previousSubpage,i=c._currentSubpage,o==a?c.switchSubpage(n,i,e):a==r.ec&&(t.each(n==i?[n]:[n,i],function(t,n){n&&n.onsubpagebeforechange&&n.onsubpagebeforechange(e),n&&n.onsubpageafterchange&&n.onsubpageafterchange(e)}),c.recycleSubpage())}},getSubpageManager:function(t){var e,n=this;return(e=n.subpageManager)?e:e=n.subpageManager=new rocket.subpagemanager(t,n)},refreshViewHeight:function(){var t,e=this,n=(new Date).getTime();return rocket.isLoaded?(e.refreshRequestStack=e.refreshRequestStack||[],e.lastRefreshTime=e.lastRefreshTime||n,t=e.refreshRequestStack,n-e.lastRefreshTime<1e3&&e.isNotFirstRefresh?(t.push(1),void 0):(t.length=0,setTimeout(function(){e.refreshHeight&&e.refreshHeight(),e.lastRefreshTime=(new Date).getTime(),setTimeout(function(){t.length>0&&(t.length=0,e.refreshHeight&&e.refreshHeight())},1e3)},0),e.isNotFirstRefresh=!0,void 0)):(setTimeout(function(){e.refreshViewHeight()},200),void 0)},tip:function(e,n){var i=t("#wrapper"),r=i.children(".global-tip");switch(0==r.length&&(r=t('<div class="global-tip"><span></span></div>'),i.append(r)),r.find("span").text(e),r.css("top",i.height()/2+"px"),n){case 0:r.css("text-align","center");break;case 1:r.css("text-align","left");break;case 2:r.css("text-align","right")}r.show(),setTimeout(function(){r.animate({opacity:0},500,"",function(){r.hide(),r.css({"-webkit-transition":"none",opacity:1})})},1500)},show:function(){var t=this;setTimeout(function(){t.$el.show(),t.onsubviewshow&&t.onsubviewshow()},0)},hide:function(){this.$el.hide()},navigate:function(t){Backbone.history.navigate(t,{trigger:!0})}})}(Zepto),!function(){rocket.collection=Backbone.Collection.extend({initialize:function(){}})}(Zepto),!function(){rocket.model=Backbone.Model.extend({initialize:function(){}})}(Zepto),!function(t){rocket.pageview=rocket.baseview.extend({initialize:function(t,e){var n=this;if(!e)throw Error("pageview creation: must supply non-empty action parameter");n.action=e,n._tops={},n._currentLogicString=n._getLogicString(t),rocket.baseview.prototype.initialize.call(n,t,null)},isActivePage:function(){var t=this;return"block"==t.$el.css("display")},_getLogicString:function(e){return t.param(e||{},!0)||"__empty_logic_string__"},savePos:function(){var t=this;t._tops[t._currentLogicString]=window.scrollY},restorePos:function(t){var e=this,n=e._currentLogicString=e._getLogicString(t);setTimeout(function(){window.scrollTo(0,e._tops[n]||0)},0)}})}(Zepto),!function(){rocket.subpageview=rocket.baseview.extend({initialize:function(t,e){if(!(e instanceof rocket.baseview))throw Error("rocket.subpageview creation: must supply parentView, which is an instance of rocket.baseview");rocket.baseview.prototype.initialize.call(this,t,e)},isActiveSubpage:function(){var t=this;return"block"==t.$el.css("display")}})}(Zepto),!function(t){rocket.router=Backbone.Router.extend({initialize:function(){this.views={},this.currentView=null,this.previousView=null},routes:{},pageOrder:[],defaultPageTransition:"simple",pageTransition:{},doAction:function(t,e){var n=this,i=n.views[t];i||(i=n.views[t]=new rocket.pageview[t](e,t)),n.previousView=n.currentView,n.currentView=i,n.trigger("routechange",{from:n.previousView,to:n.currentView}),n.switchPage(n.previousView,n.currentView,e)},switchPage:function(e,n,i){var r,o,a=this,s=0,u=a.pageOrder,c=e&&e.action||null,l=n&&n.action||null;null!==c&&null!==l&&c!==l&&-1!=(r=u.indexOf(c))&&-1!=(o=u.indexOf(l))&&(s=r>o?2:1),a.enablePositionRestore&&e&&e.savePos(),t.each(e==n?[e]:[e,n],function(t,e){e&&e.trigger("pagebeforechange",{from:a.previousView,to:a.currentView,params:i})}),a.doAnimation(e,n,s,function(){a.enablePositionRestore&&n&&n.restorePos(i),t.each(e==n?[e]:[e,n],function(t,e){e&&e.trigger("pageafterchange",{from:a.previousView,to:a.currentView,params:i})})})},doAnimation:function(t,e,n,i){var r,o=this;r=o._selectAnimation(t&&t.action||null,e&&e.action||null)||rocket["pageanimation_"+o.defaultPageTransition].animate,r(t&&t.el,e&&e.el,n,i)},_selectAnimation:function(t,e){if(null!=t&&null!=e){var n,i=this;return n=i.pageTransition[t+"-"+e]||i.pageTransition[e+"-"+t],rocket["pageanimation_"+n]&&rocket["pageanimation_"+n].animate}}})}(Zepto),!function(){rocket.subview=rocket.baseview.extend({initialize:function(t,e){if(!(e instanceof rocket.baseview))throw Error("rocket.subview creation: must supply parentView, which is an instance of rocket.baseview");rocket.baseview.prototype.initialize.call(this,t,e)}})}(Zepto),!function(t){rocket.globalview=rocket.baseview.extend({initialize:function(t,e){var n=this;if(!e||!e instanceof rocket.router)throw Error("globalview creation: must supply an instance of rocket.router");n.router=e,n.router.on("routechange",n._onroutechange,n),rocket.baseview.prototype.initialize.call(n,t,null)},isActivePage:function(){return!1},_onroutechange:function(e){var n=this;e.from,e.to,e.pageviews,n.trigger("routechange",t.extend({},e))},triggerPageEvent:function(e,n,i){var r,o=this,a=e.split(/\s*,\s*/);t.each(a,function(t,e){r=o.router.views[e],r&&r.trigger(n,i)})},getCurrentAction:function(){return this.router&&this.router.currentView.action||""}})}(Zepto),!function(t){rocket.subpagemanager=function(t,e){var n=this,i=t||{};n._subpageClass=i.subpageClass||null,n.MAX_SUBPAGES=i.maxSubpages||3,n.subpageTransition=i.subpageTransition||"slide",n.subpageManagerView=e,n._subpages=[],n._currentSubpage=null,n._previousSubpage=null,n.defaultSubpageTransition="slide"},rocket.subpagemanager.prototype={switchSubpage:function(e,n,i){var r=this,o=0;o=r.subpageManagerView.getSubpageSwitchDir?r.subpageManagerView.getSubpageSwitchDir(e,n):r.getSubpageSwitchDir(e,n),t.each(e==n?[e]:[e,n],function(t,e){e&&e.onsubpagebeforechange&&e.onsubpagebeforechange(i)}),r.doSubpageAnimation(e,n,o,function(){t.each(e==n?[e]:[e,n],function(t,e){e&&e.onsubpageafterchange&&e.onsubpageafterchange(i)}),r.recycleSubpage()})},getSubpageSwitchDir:function(t,e){for(var n=this,i=0,r=n._subpages,o=t&&t.getFeatureString()||null,a=e&&e.getFeatureString()||null,s=-1,u=-1,c=0;c<r.length;c++)r[c].name==o&&(s=c),r[c].name==a&&(u=c);return null!==o&&null!==a&&o!==a&&-1!=s&&-1!=u&&(i=s>u?2:1),i},doSubpageAnimation:function(t,e,n,i){var r,o=this;r=rocket["pageanimation_"+o.subpageTransition].animate,r(t&&t.el,e&&e.el,n,i)},registerSubpage:function(t,e){var n=this;n.getSubpage(t)||n._subpages.push({name:t,subpage:e})},getSubpage:function(t){for(var e=this,n=e._subpages,i=0,r=n.length;r>i;i++)if(n[i].name==t)return n[i].subpage},setCurrentSubpage:function(t){var e=this;if(!(t instanceof rocket.baseview))throw Error("error in method setCurrentSubpage: subpage is not an instance of rocket.baseview");t!=e._currentSubpage&&(e._previousSubpage=e._currentSubpage,e._currentSubpage=t)},recycleSubpage:function(){for(var t,e=this,n=e._subpages;n.length>e.MAX_SUBPAGES;)t=n.shift(),t.subpage==e._currentSubpage?e._subpages.push(t):t.subpage.destroy()}}}(Zepto),!function(t){function e(t,e,n){return"translate"+(rocket.has3d?"3d":"")+"("+t+"px, "+e+"px"+(rocket.has3d?", "+n+"px)":")")}rocket.pageanimation_dropdown={},rocket.pageanimation_dropdown.animate=function(n,i,r,o,a){if(0===r)return n!=i&&(n&&t(n).hide(),setTimeout(function(){i&&t(i).show()},0)),o&&o(),void 0;a=!0,i=t(i),n=t(n);var s=document.documentElement.clientHeight,s=t(window).height();1==r?(n.css("z-index",1e3),i.css("z-index",999)):(n.css("z-index",999),i.css("z-index",1e3)),n.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":e(0,0,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial"}),i.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":e(0,1===r?"0":"-"+s,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial",display:"block"}),setTimeout(function(){function t(){a?(n.css({display:"none","-webkit-transform":e(0,0,0),"-webkit-transition-duration":"0ms"}),i.css({display:"block","-webkit-transform":e(0,0,0),"-webkit-transition-duration":"0ms"})):(n.css({display:"none"}),i.css({display:"block"}))}1==r?n.css({"-webkit-transform":e(0,-s,0),"-webkit-transition-duration":"450ms"}):i.css({"-webkit-transform":e(0,0,0),"-webkit-transition-duration":"450ms"}),setTimeout(function(){setTimeout(function(){t(),o&&o()},0)},500)},0)}}(Zepto),!function(t){rocket.pageanimation_fade={},rocket.pageanimation_fade.animate=function(e,n,i,r){var o=e&&t(e),a=n&&t(n);n&&(e&&e!=n?(o.hide(),a.show(),a.css({opacity:.05}),a.animate({opacity:1},600,"ease-in",r)):(a.show(),r&&r()))}}(Zepto),!function(t){rocket.pageanimation_simple={},rocket.pageanimation_simple.animate=function(e,n,i,r){var o=e&&t(e),a=n&&t(n);e!=n&&(e&&o.hide(),setTimeout(function(){n&&a.show()},0)),r&&r()}}(Zepto),!function(t){function e(t,e,n){return"translate"+(rocket.has3d?"3d":"")+"("+t+"px, "+e+"px"+(rocket.has3d?", "+n+"px)":")")}rocket.pageanimation_slide={},rocket.pageanimation_slide.animate=function(n,i,r,o,a){if(0===r)return n!=i&&(n&&t(n).hide(),setTimeout(function(){i&&t(i).show()},0)),o&&o(),void 0;a=!0,i=t(i),n=t(n);var s=document.documentElement.clientWidth;n.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":e(0,0,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial"}),i.css({"-webkit-transition-property":"-webkit-transform","-webkit-transform":e((1===r?"":"-")+s,0,0),"-webkit-transition-duration":"0ms","-webkit-transition-timing-function":"ease-out","-webkit-transition-delay":"initial",display:"block"}),setTimeout(function(){function t(){a?(n.css({display:"none","-webkit-transform":e(0,0,0),"-webkit-transition-duration":"0ms"}),i.css({display:"block","-webkit-transform":e(0,0,0),"-webkit-transition-duration":"0ms"})):(n.css({display:"none"}),i.css({display:"block"}))}i.css({"-webkit-transform":e(0,0,0),"-webkit-transition-duration":"350ms"}),n.css({"-webkit-transform":e((1===r?"-":"")+s,0,0),"-webkit-transition-duration":"350ms"}),setTimeout(function(){setTimeout(function(){t(),o&&o()},0)},400)},0)}}(Zepto);